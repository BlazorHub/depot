@attribute [Authorize]
@page "/group"

@using Microsoft.AspNetCore.Authorization
@using depot.Shared.RequestModels

@inject depot.Client.Services.API API
@inject depot.Client.Services.AppState _appState
@inject IToastService _toastService
@inject NavigationManager _navigationManager

<h3>Creating a Group? Lets take care of that.</h3>
<p>Create a group. All data must be part of a group. This group name can be changed at any time.</p>
<div class="mt-1">
    <input type="text" placeholder="Group Name" class="form-control" @bind="GroupName" />
</div>
<div class="mt-1">
    <input type="button" class="btn btn-info" value="Create Group" @onclick="CreateGroup" />
</div>

@code {

    public string GroupName { get; set; }

    public async Task CreateGroup()
    {
        var content = new GroupCreateEditRequestModel() { Name = GroupName };

        var response = await API.GroupCreate(content);
        _toastService.ShowSuccess("Group Created. Switching to Group...");

        await Task.Delay(1000);
        await _appState.UpdateAppState();
        _navigationManager.NavigateTo($"/group/{response.Id}");
    }
}